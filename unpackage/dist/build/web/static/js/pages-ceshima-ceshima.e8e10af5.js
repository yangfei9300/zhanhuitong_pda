(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-ceshima-ceshima"],{"3bcc":function(t,n,e){"use strict";e.r(n);var i=e("b75e"),o=e("9a9e");for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(n,t,(function(){return o[t]}))}(a);e("b6a2");var c=e("828b"),s=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,"8eb74b4a",null,!1,i["a"],void 0);n["default"]=s.exports},"6a3f":function(t,n,e){e("bf0f"),e("c223"),e("d4b5"),t.exports={dbName:"zht",dbPath:"_downloads/zht.db",isOpen:function(){var t=plus.sqlite.isOpenDatabase({name:this.dbName,path:this.dbPath});return t},openSqlite:function(){var t=this;return new Promise((function(n,e){plus.sqlite.openDatabase({name:t.dbName,path:t.dbPath,success:function(t){n(t)},fail:function(t){e(t)}})}))},closeSqlite:function(){var t=this;return new Promise((function(n,e){plus.sqlite.closeDatabase({name:t.dbName,success:function(t){n(t)},fail:function(t){e(t)}})}))},createTable:function(t,n){var e=this;return new Promise((function(i,o){plus.sqlite.executeSql({name:e.dbName,sql:"CREATE TABLE IF NOT EXISTS ".concat(t,"(").concat(n,")"),success:function(t){i(t)},fail:function(t){o(t)}})}))},dropTable:function(t){var n=this;return new Promise((function(e,i){plus.sqlite.executeSql({name:n.dbName,sql:"DROP TABLE ".concat(t),success:function(t){e(t)},fail:function(t){i(t)}})}))},insertTableData:function(t,n,e){var i=this;if(void 0!==t&&void 0!==n){var o="{}"==JSON.stringify(n);if(o)return new Promise((function(t,n){n("错误添加")}));if(void 0==e)var a="INSERT INTO ".concat(t," VALUES('").concat(n,"')");else a="INSERT INTO ".concat(t," (").concat(e,") VALUES(").concat(n,")");return new Promise((function(t,n){plus.sqlite.executeSql({name:i.dbName,sql:a,success:function(n){t(n)},fail:function(t){n(t)}})}))}return new Promise((function(t,n){n("错误添加")}))},insertOrReplaceData:function(t,n,e){var i=this;if(void 0!==t&&void 0!==n){if(void 0==e)var o="INSERT OR REPLACE INTO ".concat(t," VALUES('").concat(n,"')");else o="INSERT OR REPLACE INTO ".concat(t," (").concat(e,") VALUES(").concat(n,")");return new Promise((function(t,n){plus.sqlite.executeSql({name:i.dbName,sql:o,success:function(n){t(n)},fail:function(t){n(t)}})}))}return new Promise((function(t,n){n("错误添加")}))},selectTableData:function(t,n,e,i,o,a,c,s,l){var r=this;if(void 0!==t){if(void 0!==n&&void 0!==i&&void 0!==a&&void 0!==s)var u="SELECT * FROM ".concat(t," WHERE ").concat(n," = '").concat(e,"' AND ").concat(i," = '").concat(o,"' AND ").concat(a,"='").concat(c,"' AND ").concat(s,"='").concat(l,"' ");else if(void 0!==n&&void 0!==i&&void 0!==a)u="SELECT * FROM ".concat(t," WHERE ").concat(n," = '").concat(e,"' AND ").concat(i," = '").concat(o,"' AND ").concat(a,"='").concat(c,"'");if(void 0!==n&&void 0!==i&&void 0==a)u="SELECT * FROM ".concat(t," WHERE ").concat(n," = '").concat(e,"' AND ").concat(i," = '").concat(o,"'");if(void 0!==n&&void 0==i&&void 0==a)u="SELECT * FROM ".concat(t," WHERE ").concat(n," = '").concat(e,"'");if(void 0==n)u="SELECT * FROM ".concat(t);return console.log("查询sql语句",u),new Promise((function(t,n){plus.sqlite.selectSql({name:r.dbName,sql:u,success:function(n){t(n)},fail:function(t){n(t)}})}))}return new Promise((function(t,n){n("错误查询")}))},selectTableData1:function(t,n){var e=this;if(void 0!==t){var i="SELECT * FROM "+t+" where isUpload='false' and  isLine='false'  LIMIT "+n;return console.log("查询sql语句",i),new Promise((function(t,n){plus.sqlite.selectSql({name:e.dbName,sql:i,success:function(n){t(n)},fail:function(t){n(t)}})}))}return new Promise((function(t,n){n("错误查询")}))},selectgetTotalCont:function(t){var n=this;if(void 0!==t){var e="select count(*) count FROM "+t+" WHERE isUpload='false' and isLine='false'";return console.log("查询sql语句",e),new Promise((function(t,i){plus.sqlite.selectSql({name:n.dbName,sql:e,success:function(n){t(n)},fail:function(t){i(t)}})}))}return new Promise((function(t,n){n("错误查询")}))},deleteTableData:function(t,n,e,i,o){var a=this;if(void 0!==t){if(void 0==n)var c="DELETE FROM ".concat(t);else if(void 0!==i)c="DELETE FROM ".concat(t," WHERE ").concat(n," = '").concat(e,"' AND ").concat(i," = '").concat(o,"'");else c="DELETE FROM ".concat(t," WHERE ").concat(n," = '").concat(e,"'");return new Promise((function(t,n){plus.sqlite.executeSql({name:a.dbName,sql:c,success:function(n){t(n)},fail:function(t){n(t)}})}))}return new Promise((function(t,n){n("错误删除")}))},updateTableData:function(t,n,e,i){var o=this;if(void 0==e)var a="UPDATE ".concat(t," SET ").concat(n);else a="UPDATE ".concat(t," SET ").concat(n," WHERE ").concat(e," = '").concat(i,"'");return new Promise((function(t,n){plus.sqlite.executeSql({name:o.dbName,sql:a,success:function(n){t(n)},fail:function(t){n(t)}})}))},pullSQL:function(t,n,e){var i=this;return new Promise((function(o,a){plus.sqlite.selectSql({name:i.dbName,sql:"SELECT * FROM ".concat(t," ORDER BY '").concat(n,"' DESC LIMIT 15 OFFSET '").concat(e,"'"),success:function(t){o(t)},fail:function(t){a(t)}})}))},selWuxiaoNum:function(){var t=this;return new Promise((function(n,e){plus.sqlite.selectSql({name:t.dbName,sql:'SELECT count(*) count FROM scan_info WHERE isLine="false" AND isUpload="no"',success:function(t){n(t)},fail:function(t){e(t)}})}))},delWuxiaodata:function(){var t=this;return new Promise((function(n,e){plus.sqlite.selectSql({name:t.dbName,sql:"DELETE FROM scan_info WHERE isUpload ='no'",success:function(t){n(t)},fail:function(t){e(t)}})}))}}},"74b2":function(t,n,e){"use strict";e("6a54");var i=e("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(e("6a3f")),a={data:function(){return{list:[],options:{type:2},countTotal:0,nowIndex:0,wuxiaoNum:0}},onLoad:function(t){this.openSQL()},methods:{saomaa:function(){var t=this;o.default.createTable("scan_error_info",sql).then((function(n){console.log("创建scan_error_info表成功",n),t.$tools.showToast("创建scan_error_info表成功",error)})).catch((function(n){console.log("创建表失败"),t.$tools.showToast("创建scan_error_info表失败",n)}))},clearTableClick:function(){uni.navigateTo({url:"/pages/clearData/clearData"})},getbaifenbi:function(t){this.nowIndex=t/this.list.length*100,this.nowIndex=this.nowIndex.toFixed(0)},toHome:function(){uni.reLaunch({url:"/pages/login/login"})},openSQL:function(){var t=this,n=o.default.isOpen();console.log("数据库状态",n?"开启":"关闭"),n?(this.getYeji("scan_error_info"),this.getZong("scan_error_info"),this.delInvalidInfo()):o.default.openSqlite().then((function(n){console.log("数据库已打开"),t.getYeji("scan_error_info"),t.getZong("scan_error_info"),t.delInvalidInfo()})).catch((function(t){console.log("数据库开启失败")}))},getZong:function(t){var n=this;console.log("总个数",t),o.default.selectgetTotalCont(t).then((function(t){console.log("总个数",t),n.countTotal=t[0].count})).catch((function(t){n.$tools.showToast("查询失败")}))},getYeji:function(t){var n=this;o.default.selectTableData1(t,100).then((function(t){n.list=t})).catch((function(t){console.log("error",t),n.$tools.showToast("查询失败")}))},toStartUpload:function(){var t=this;uni.showModal({title:"提示",content:"确定要上传吗？",success:function(n){n.confirm?t.list.length>0?t.toUploadItem(t.list[0],0):t.$tools.showToast("无离线数据。"):n.cancel&&console.log("用户点击取消")}})},toUploadItem:function(t,n){var e=this;if(t.activityId){var i={exhId:t.exhId,unionid:t.unionid,userId:"359",activityId:t.activityId,createTime:t.createTime};console.log("开始核销论坛",this.$paths.activitypda,i),this.$axios.axios("post",this.$paths.activitypda,i).then((function(i){console.log("论坛结果",i,200==i.code),200==i.code?e.updateBendiDB(t,n,"yes"):(e.$tools.showToast(i.msg),setTimeout((function(i){e.updateBendiDB(t,n,"no")}),500))})).catch((function(t){console.log("报错",t)}))}else{i={exhId:t.exhId,params:{unionid:t.unionid,userId:"359",doorId:t.doorId},createTime:t.createTime};this.$axios.axios("post",this.$paths.visitpdaapi,i).then((function(i){console.log("核销入口结果",i),200==i.code?e.updateBendiDB(t,n,"yes"):(e.$tools.showToast(i.msg),setTimeout((function(i){e.updateBendiDB(t,n,"no")}),500))})).catch((function(t){console.log("报错了",t)}))}},updateBendiDB:function(t,n,e){var i=this,a='isUpload="true"';"no"==e&&(a='isUpload="no"'),o.default.updateTableData("scan_error_info",a,"id",t.id).then((function(e){i.$tools.showToast(t.id+"上传成功"),n+=1,n<i.list.length?(i.toUploadItem(i.list[n],n),i.getbaifenbi(n)):(i.getbaifenbi(n),i.$tools.showToast("上传完成"),i.nowIndex=0,i.getYeji("scan_error_info"),i.getZong("scan_error_info"),i.delInvalidInfo())})).catch((function(t){console.log("修改失败",t),i.$tools.showToast("修改失败")}))},delInvalidInfo:function(){},delWuxiaodata:function(){var t=this;uni.showModal({title:"提示",content:"确定要删除无效数据吗？",success:function(n){n.confirm?o.default.delWuxiaodata().then((function(n){console.log("删除成功",n),t.$tools.showToast("无效数据删除成功"),t.delInvalidInfo()})).catch((function(n){t.$tools.showToast("无效数据删除失败")})):n.cancel}})}}};n.default=a},"9a9e":function(t,n,e){"use strict";e.r(n);var i=e("74b2"),o=e.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(a);n["default"]=o.a},a46f:function(t,n,e){var i=e("e588");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=e("967d").default;o("4e05d051",i,!0,{sourceMap:!1,shadowMode:!1})},b6a2:function(t,n,e){"use strict";var i=e("a46f"),o=e.n(i);o.a},b75e:function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return o})),e.d(n,"a",(function(){}));var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",[e("v-uni-view",{staticClass:"colonn"},[1==t.options.type?[e("v-uni-view",{staticStyle:{"text-align":"center",color:"red","font-weight":"bold",padding:"20rpx 0rpx"}},[t._v("总计："+t._s(t.list.length-1)+"条记录")]),e("v-uni-view",{staticClass:"roww rowsb border_bottom",staticStyle:{padding:"20rpx 15rpx"}},[e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v("兼职姓名")]),e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v("核销数量")]),e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v("门ID")]),e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v("日期")])],1),t._l(t.list,(function(n,i){return e("v-uni-view",{staticClass:"roww rowsb border_bottom",staticStyle:{padding:"10rpx 15rpx","line-height":"50rpx"},style:{"background-color":"总核销人数"==n.loginName?"red":"white",color:"总核销人数"==n.loginName?"white":"#000000"}},[e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v(t._s(n.loginName))]),e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v(t._s(n.count))]),e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v(t._s(n.doorId))]),"总核销人数"!=n.loginName?e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v(t._s(n.dayTime))]):e("v-uni-view",{staticClass:"allline",staticStyle:{"text-align":"center"}},[t._v(t._s(n.dayTime)+"人")])],1)}))]:t._e(),2==t.options.type?[e("v-uni-view",{staticClass:"roww rowsa center_center"},[e("v-uni-view",[t._v("上传进度")]),e("v-uni-progress",{staticStyle:{width:"500rpx"},attrs:{"show-info":!0,percent:t.nowIndex}})],1),e("v-uni-view",{staticStyle:{"text-align":"center",color:"red","font-weight":"bold","padding-top":"20rpx"}},[t._v("总剩余待上传"+t._s(t.countTotal)+"条"),e("v-uni-text",{staticStyle:{color:"blue"},on:{longpress:function(n){arguments[0]=n=t.$handleEvent(n),t.delWuxiaodata.apply(void 0,arguments)}}},[t._v("【无效数据有"+t._s(t.wuxiaoNum)+"条】")])],1),e("v-uni-view",{staticStyle:{"text-align":"center",color:"red","font-weight":"bold",padding:"20rpx 0rpx"}},[t._v("本页离线数据待上传（"+t._s(t.list.length)+"条）")]),e("v-uni-view",{staticClass:"roww rowsb border_bottom",staticStyle:{padding:"20rpx 15rpx"}},[e("v-uni-view",{staticClass:"allline w-100",staticStyle:{"text-align":"center"}},[t._v("兼职姓名")]),e("v-uni-view",{staticClass:"allline w-100",staticStyle:{"text-align":"center"}},[t._v("客户手机号")]),e("v-uni-view",{staticClass:"allline w-550",staticStyle:{"text-align":"center"},on:{longpress:function(n){arguments[0]=n=t.$handleEvent(n),t.saomaa.apply(void 0,arguments)}}},[t._v("扫码时间")])],1),t._l(t.list,(function(n,i){return e("v-uni-view",{staticClass:"roww rowsb border_bottom",staticStyle:{padding:"10rpx 15rpx"}},[e("v-uni-view",{staticClass:"allline w-100",staticStyle:{"text-align":"center"}},[t._v(t._s(n.loginName))]),e("v-uni-view",{staticClass:"allline w-100",staticStyle:{"text-align":"center"}},[t._v(t._s(n.unionid))]),e("v-uni-view",{staticClass:"allline w-550",staticStyle:{"text-align":"center"}},[t._v(t._s(n.createTime))])],1)}))]:t._e()],2),e("v-uni-view",{staticClass:"leftbo",on:{longpress:function(n){arguments[0]=n=t.$handleEvent(n),t.toStartUpload.apply(void 0,arguments)}}},[t._v("离线数据上传")]),e("v-uni-view",{staticClass:"centerbo yincang1",on:{longpress:function(n){arguments[0]=n=t.$handleEvent(n),t.clearTableClick.apply(void 0,arguments)}}},[t._v("清理表格")]),e("v-uni-view",{staticClass:"rightbo",on:{click:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.toHome.apply(void 0,arguments)}}},[t._v("返回首页")])],1)},o=[]},e588:function(t,n,e){var i=e("c86c");n=i(!1),n.push([t.i,".leftbo[data-v-8eb74b4a]{width:%?200?%;height:%?50?%;background-color:#00f;color:#fff;line-height:%?50?%;border-radius:%?15?%;text-align:center;position:fixed;bottom:%?40?%;padding:%?0?% %?10?%;left:%?40?%}.centerbo[data-v-8eb74b4a]{width:%?300?%;height:%?50?%;background-color:#00f;color:#fff;line-height:%?50?%;border-radius:%?15?%;text-align:center;position:fixed;bottom:%?40?%;padding:%?0?% %?10?%;left:%?250?%}.rightbo[data-v-8eb74b4a]{width:%?150?%;height:%?50?%;background-color:#00f;color:#fff;line-height:%?50?%;border-radius:%?15?%;text-align:center;position:fixed;bottom:%?40?%;right:%?40?%}",""]),t.exports=n}}]);